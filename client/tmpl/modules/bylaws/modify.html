<template name="Module_Bylaws_Modify">
  {{> Element_ProcessDimmer}}
  {{> Element_CloseSectionButton }}
  {{ #with action }}
  <form class="ui flex attached form">
    <h1 class="ui header">
      {{ name }}
      <div class="sub header">{{ description }}</div>
    </h1>
    <div class="ui hidden divider"></div>
    <div class="field">
      <label>Action requirement</label>
      <div class="ui selection dropdown" id="trigger">
        <input type="hidden" name="trigger" value="{{ intToTrigger bylaw.type }}">
        <i class="dropdown icon"></i>
        <div class="default text">(triggers this).[(intToTrigger bylaw.type)]</div>
        <div class="menu">
          {{ #each triggers this }}
          <div class="item" data-value="{{ value }}" data-disabled="{{ disabled }}">
            {{ title }}
          </div>
          {{ /each }}
        </div>
      </div>
    </div>
    {{ #if $eq (TemplateVar.get 'selectedTrigger') 'voting' }}
    <div class="two fields">
      <div class="field">
        <label>Support needed (%)</label>
        <input type="number" name="supportNeeded" min="1" max="100" value="{{ numbersToPercentage bylaw.details.supportNeeded bylaw.details.supportBase }}">
      </div>
      <div class="field">
        <label>Minimum voting time (days)</label>
        <input type="number" name="minimumVotingTime" value="{{ secondsToDays bylaw.details.minimumVotingTime }}">
      </div>
    </div>
    <div class="field">
      <div class="ui toggle checkbox" id="closingRelativeMajority">
        <input type="checkbox" tabindex="0" class="hidden" name="closingRelativeMajority" checked="{{ #if bylaw.details.closingRelativeMajority }}checked{{/if}}">
        <label>Relative majority</label>
      </div>
    </div>
    {{ /if }}
    {{ #if $eq (TemplateVar.get 'selectedTrigger') 'status' }}
    <div class="field">
      <label>Needed status</label>
      <select class="ui fluid selection dropdown" name="status" id="status">
        {{ #each statuses }}
        <option value="{{ value }}" selected="{{ #if $eq ../bylaw.details.neededStatus (statusToInt value) }}selected{{ /if }}">{{ title }}</option>
        {{ /each }}
      </select>
    </div>
    {{ /if }}
    <div class="ui spacer"></div>
    <button class="ui fluid big primary button" type="submit">Save</button>
  </form>
  {{ /with }}

  <div class="ui small modal">
    <div class="header">
      Bylaws change confirmation
    </div>
    <div class="content">
      <div class="description">
        <p>Changing your company's bylaws has real implications on its functioning.</p>
        <p>Please make sure this is a desired action.</p>
        <p>A voting will be created and 90% of the voting power will be needed in order to confirm the change.</p>
      </div>
    </div>
    <div class="actions">
      <div class="ui deny button">
        Yes, I want to change the bylaws
      </div>
      <div class="ui positive button">
        Cancel
      </div>
    </div>
  </div>
</template>
